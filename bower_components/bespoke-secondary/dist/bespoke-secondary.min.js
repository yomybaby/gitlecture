/*! bespoke-secondary v0.2.0 Â© 2013 Joel Purra, Licensed MIT */
!function(a,b,c,d,e,f,g,h){"use strict";var i=e.builder({pluginName:g,dependencies:["indexfinger"]}),j={S:83},k={notes:"aside",keys:{toggle:j.S}},l=function(a,b){var d;b===h&&(b=a,a=0),d=b-a;var e=a+c.floor(c.random()*d);return e},m=g+"-window-",n=function(){var a=l(1e3,1e4),b=m+a;return b},o=function(a){a.body.innerHTML="<h1>Notes</h1><div id='notes'></div>"},p=function(c,d){var e={},f={getNotesElement:function(){return this.secondary.window&&this.secondary.window.document&&this.secondary.window.document.getElementById("notes")},isOpen:function(){var b=this.secondary,c=b.window,d=!0&&b!==h&&null!==c&&c.closed!==!0&&c.opener===a&&null!==this.secondary.getNotesElement();return d},open:function(){return this.secondary.isOpen()||(this.secondary.window=a.open(),o(this.secondary.window.document)),this.secondary.isOpen()},close:function(){return this.secondary.isOpen()&&this.secondary.window.close(),!this.secondary.isOpen()},focus:function(){return this.secondary.isOpen()&&this.secondary.window.focus(),this.secondary.isOpen()},toggle:function(){return this.secondary.isOpen()?this.secondary.close():this.secondary.open(),this.secondary.isOpen()},synchronize:function(){var a,b,c,e;return this.secondary.isOpen()?(a=this.secondary.getNotesElement(),b=this.getActiveSlide(),c=i.copyArray(b.querySelectorAll(d.notes)),e=c.reduce(function(a,b){return a+b.outerHTML},""),a.innerHTML=e,this.secondary.isOpen()):!1}},g=function(){c.secondary={window:null,secondaryWindowName:n(),getNotesElement:f.getNotesElement.bind(c),isOpen:f.isOpen.bind(c),open:f.open.bind(c),close:f.close.bind(c),focus:f.focus.bind(c),toggle:f.toggle.bind(c),synchronize:f.synchronize.bind(c)}},j=function(){var a={};a.keys={},a.keys.toggle=d.keys&&d.keys.toggle||k.keys.toggle,a.notes=d.notes||k.notes,d=a},l=function(a){var b=!1;return a.altKey||a.ctrlKey||a.metaKey||a.shiftKey||(b=b||a.which===d.keys.toggle&&i.fire(c,"toggle",a)&&c.secondary.toggle()&&c.secondary.synchronize()),b&&a.preventDefault(),!b},m=function(){return c.secondary.close(),null},p=function(){c.secondary.synchronize()},q=function(){a.onbeforeunload=m,b.addEventListener("keydown",l,!1),e.activate=c.on("activate",p)},r=function(){i.activateDeck(c),j(),g(),q()};r()};if(f[g]!==h)throw i.generateErrorObject("The "+g+" plugin has already been loaded.");f[g]=p}(window,document,Math,bespoke,bespoke.plugins.convenient,bespoke.plugins,"secondary");